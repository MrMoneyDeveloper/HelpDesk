@model C8.eServices.Mvc.ViewModels.LoginViewModel
@using C8.eServices.Mvc.Models;
@{
    Layout = null;
    ViewBag.Title = "Log in";
}

<!doctype html>
<html lang="en">

<head>

    <meta charset="utf-8" />
    <title>Sign In | XET Helpdesk</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Premium Multipurpose Admin & Dashboard Template" name="description" />
    <meta content="Pichforest" name="author" />
    <!-- App favicon -->
    @*<link rel="shortcut icon" href="assets/images/favicon.ico">*@

    <!-- Bootstrap Css -->
    <link href="~/assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css" />
    <!-- Icons Css -->
    <link href="~/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <!-- App Css-->
    <link href="~/assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css" />
    <link href="~/assets/css/custom/custom.css" rel="stylesheet" />



    <link href="~/assets/libs/jsvectormap/css/jsvectormap.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css" />
    <link href="~/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css" />


    <link href="~/assets/libs/choices.js/public/assets/styles/choices.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/libs/flatpickr/flatpickr.min.css" rel="stylesheet">

    <!-- One of the following themes -->
    <link rel="stylesheet" href="~/assets/libs/simonwep/pickr/themes/classic.min.css" /> <!-- 'classic' theme -->
    <link rel="stylesheet" href="~/assets/libs/simonwep/pickr/themes/monolith.min.css" /> <!-- 'monolith' theme -->
    <link rel="stylesheet" href="~/assets/libs/simonwep/pickr/themes/nano.min.css" /> <!-- 'nano' theme -->
    <!-- alertifyjs Css -->
    <link href="~/assets/libs/alertifyjs/build/css/alertify.min.css" rel="stylesheet" type="text/css" />

    <!-- alertifyjs default themes  Css -->
    <link href="~/assets/libs/alertifyjs/build/css/themes/default.min.css" rel="stylesheet" type="text/css" />

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <link rel="stylesheet" href="~/assets/css/Icon.css">

    <script>
        // Add the show class to icons after the page loads
        document.addEventListener("DOMContentLoaded", function () {
            var icons = document.querySelectorAll(".material-icons");
            icons.forEach(function (icon) {
                icon.classList.add("show");
            });
        });
    </script>

    <style>
        .material-icons {
            font-family: 'Material Icons';
            font-weight: normal;
            font-style: normal;
            font-size: 20px;
            display: inline-table;
            line-height: 1;
            text-transform: none;
            letter-spacing: normal;
            word-wrap: normal;
            white-space: nowrap;
            direction: ltr;
            color: cornflowerblue;
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
            -moz-osx-font-smoothing: grayscale;
            font-feature-settings: 'liga';
            opacity: 0; /* Start with zero opacity */
            transform: translateY(10px); /* Start position below */
            transition: opacity 1s ease, transform 1s ease; /* Transition animations */
        }

        .show {
            opacity: 1;
            transform: translateY(0); /* End position at normal position */
        }
    </style>


</head>
<body>
    <!-- <body data-layout="horizontal"> -->
    <div class="authentication-bg min-vh-100">
        <div class="bg-overlay bg-white"></div>
        <div class="container">
            <div class="d-flex flex-column min-vh-100 px-3 pt-4">
                <div class="row justify-content-center my-auto">
                    <div class="col-md-8 col-lg-6 col-xl-4">

                        <div class="text-center  py-5">
                            <div class="mb-4 mb-md-5">
                                <a href="index.html" class="d-block auth-logo">
                                    <span></span>
                                    @*<img src="assets/images/logo-dark.png" alt="" height="22" class="auth-logo-dark">
                                        <img src="assets/images/logo-light.png" alt="" height="22" class="auth-logo-light">*@
                                </a>
                            </div>
                            <div class="mb-4">
                                <h5>Welcome Back !</h5>
                                <p>Sign in to continue to XET Helpdesk.</p>
                            </div>
                            @using (Html.BeginForm("Login", "Account", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
                            {
                                @Html.AntiForgeryToken()
                                if (ViewBag.Error != null)
                                {
                                    <div class="form-floating form-floating-custom mb-3">
                                        <div class="alert alert-warning text-center mb-4" role="alert">@ViewBag.Error</div>
                                    </div>
                                }
                                <div class="form-floating form-floating-custom mb-3">
                                    <input type="text" class="form-control" id="input-username" name="UserName" placeholder="Enter User Name" required>
                                    <label for="input-username">Username</label>
                                    <div class="form-floating-icon">
                                        <i class="uil uil-users-alt"></i>
                                    </div>
                                </div>
                                <div class="form-floating form-floating-custom mb-3">
                                    <input type="password" class="form-control" id="input-password" name="Password" placeholder="Enter Password" required>
                                    <label for="input-password">Password</label>
                                    <div class="form-floating-icon">
                                        <i class="uil uil-padlock"></i>
                                    </div>
                                </div>

                                <div class="form-check form-check-info font-size-16">
                                    <input class="form-check-input" type="checkbox" id="remember-check">
                                    <label class="form-check-label font-size-14" for="remember-check">Remember me</label>
                                </div>

                                <div class="mt-3">
                                    <button class="btn btn-info w-100" type="submit">Log In</button>
                                </div>

                                <div class="mt-4">
                                    <a href="~/Account/ForgotPassword" class="text-muted text-decoration-underline">Forgot your password?</a>
                                </div>
                            }
                            <div class="mt-5 text-center text-muted">
                                <p>Don't have an account ? <a href="#" data-bs-toggle="modal" data-bs-target="#staticBackdrop" class="fw-medium text-decoration-underline"> Signup </a></p>
                            </div>
                            <!-- Button trigger modal -->
                            @*<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                                    Launch static backdrop modal
                                </button>*@

                            <!-- Modal -->
                            <div class="modal fade bs-example-modal-xl" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h1 class="modal-title fs-5" id="staticBackdropLabel">Onboarding Request</h1>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="btnCloseOnboardingId"></button>
                                        </div>
                                        <div class="modal-body col-md-12">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <h4 class="card-title">Onboarding Steps</h4>
                                                        </div><!-- end card header -->
                                                        <form id="companyForm">
                                                            <div class="card-body">
                                                                <ul class="wizard-nav mb-5">
                                                                    <li class="wizard-list-item">
                                                                        <div class="list-item">
                                                                            <div class="step-icon" data-bs-toggle="tooltip" data-bs-placement="top" title="Company Details">
                                                                                <i class="uil uil-clipboard-notes"></i>
                                                                            </div>
                                                                        </div>
                                                                    </li>
                                                                    <li class="wizard-list-item">
                                                                        <div class="list-item">
                                                                            <div class="step-icon" data-bs-toggle="tooltip" data-bs-placement="top" title="Primary Contact Person">
                                                                                <i class="uil uil-user-check"></i>
                                                                            </div>
                                                                        </div>
                                                                    </li>
                                                                </ul>
                                                                <ul class="wizard-nav mb-5">
                                                                    <li class="wizard-list-item">
                                                                        <div class="list-item">
                                                                            <!-- error message here -->
                                                                            <div class="alert alert-danger alert-top-border alert-dismissible fade show " role="alert" style="margin-left:70px; width:300px; display:none;" id="errorId">
                                                                                <i class="uil uil-exclamation-octagon font-size-16 text-danger me-2 "></i>
                                                                                Please fill in all required fields.
                                                                                <button type="button" onclick="addHidden()" class="btn-close" aria-label="Close"></button>
                                                                            </div>
                                                                            <!-- error message here 3nd -->
                                                                        </div>
                                                                    </li>
                                                                </ul>
                                                                <!-- wizard-nav -->
                                                                <div class="wizard-tab">
                                                                    <div class="text-center mb-4">
                                                                        <h5>Company Details</h5>
                                                                        <p class="card-title-desc">Fill all information below</p>
                                                                    </div>
                                                                    <div>
                                                                        <div class="row">
                                                                            <div class="col-lg-6">
                                                                                <div class="mb-3">
                                                                                    <span class="material-icons md-48">work</span>
                                                                                    <label class="form-label">Company</label>
                                                                                    <input type="text" class="form-control" id="CompayId" required placeholder="company name">
                                                                                </div>
                                                                            </div><!-- end col -->
                                                                            <div class="col-lg-6">
                                                                                <div class="mb-3">
                                                                                    <span class="material-icons md-48"> attach_money</span>
                                                                                    <label class="form-label">Vat No.</label>
                                                                                    <input type="text" class="form-control" id="VatNoId" required placeholder="bexxxxxxxxx">
                                                                                </div>
                                                                            </div><!-- end col -->
                                                                        </div><!-- end row -->
                                                                        <div class="row">
                                                                            <div class="col-lg-6">
                                                                                <div class="mb-3">
                                                                                    <span class="material-icons md-48"> warehouse</span>
                                                                                    <label class="form-label">Industry</label>
                                                                                    <select class="form-select" id="industryId" required>
                                                                                        <option selected>@*-- select option --*@</option>
                                                                                        @foreach (var industry in ViewBag.industry as List<Industry>)
                                                                                        {
                                                                                            <option value="@industry.Key">@industry.IndustryName</option>
                                                                                        }
                                                                                    </select>
                                                                                </div>
                                                                            </div><!-- end col -->
                                                                            <div class="col-lg-6">
                                                                                <div class="mb-3">
                                                                                    <span class="material-icons md-48">  flag_circle </span>
                                                                                    <label class="form-label">Country</label>
                                                                                    <select class="form-select" id="countryId" required>
                                                                                        <option value=""></option>
                                                                                        @foreach (var country in ViewBag.country as List<Country>)
                                                                                        {
                                                                                            <option value="@country.Key">@country.Name</option>
                                                                                        }
                                                                                    </select>
                                                                                </div>
                                                                            </div><!-- end col -->

                                                                        </div><!-- end row -->

                                                                        <div class="col-lg-12">
                                                                            <div class="mb-3">
                                                                                <span class="material-icons md-48">business</span>
                                                                                <label class="form-label">Company Domain</label>
                                                                                <input type="text" class="form-control" id="domainId" placeholder="www.domain.com">
                                                                            </div>
                                                                        </div><!-- end col -->
                                                                    </div>
                                                                </div>

                                                            </div>
                                                            <!-- wizard-tab -->
                                                            <div class="wizard-tab">
                                                                <div class="text-center mb-4">
                                                                    <h5>Primary Contact Person</h5>
                                                                    <p class="card-title-desc">Fill all information below</p>
                                                                </div>
                                                                <div>
                                                                    <div class="row">
                                                                        <div class="col-lg-6">
                                                                            <div class="mb-3">
                                                                                <span class="material-icons md-48">   perm_identity </span>
                                                                                <label class="form-label">First name</label>
                                                                                <input type="text" class="form-control" id="fistnameId" placeholder="john">
                                                                            </div>
                                                                        </div><!-- end col -->
                                                                        <div class="col-lg-6">
                                                                            <div class="mb-3">
                                                                                <span class="material-icons md-48">   perm_identity </span>
                                                                                <label class="form-label">Last Name</label>
                                                                                <input type="text" class="form-control" id="lastnameId" placeholder="doe">
                                                                            </div>
                                                                        </div><!-- end col -->
                                                                    </div><!-- end row -->

                                                                    <div class="row">
                                                                        <div class="col-lg-6">
                                                                            <div class="mb-3">
                                                                                <span class="material-icons md-48">  dialpad </span>
                                                                                <label class="form-label">Phone</label>
                                                                                <input type="text" class="form-control" id="phoneId" placeholder="+278800600777">
                                                                            </div>
                                                                        </div><!-- end col -->
                                                                        <div class="col-lg-6">
                                                                            <div class="mb-3">
                                                                                <span class="material-icons md-48">    mail_outline </span>
                                                                                <label class="form-label">Email</label>
                                                                                <input type="email" class="form-control" id="emailId" placeholder="email@domain.com">
                                                                            </div>
                                                                        </div><!-- end col -->
                                                                    </div><!-- end row -->
                                                                </div>

                                                            </div>
                                                            <div class="d-flex align-items-start gap-3 mt-4">
                                                                <button type="button" class="btn btn-primary w-sm" id="prevBtn" onclick="nextPrev(-1)">Previous</button>
                                                                <button type="button" class="btn btn-primary w-sm ms-auto" id="nextBtn" onclick="checkButtonLabel();">Next</button>
                                                                <div style="display:none;">
                                                                    <input type="button" onclick="validateForm()" id="idSubmitForm" />
                                                                </div>

                                                            </div>

                                                    </div>
                                                    </form>
                                                </div>
                                            </div><!-- end col -->
                                        </div><!-- end row -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div><!-- end col -->
            </div><!-- end row -->

            <div class="row">
                <div class="col-xl-12">
                    <div class="text-center text-muted p-4">
                        <p class="mb-0">
                            &copy;
                            <script>document.write(new Date().getFullYear())</script> - XET Solutions
                        </p>
                    </div>
                </div><!-- end col -->
            </div><!-- end row -->

        </div>
    </div><!-- end container -->
    </div>
    <script src="~/assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="~/assets/libs/metismenujs/metismenujs.min.js"></script>
    <script src="~/assets/libs/simplebar/simplebar.min.js"></script>
    <script src="~/assets/libs/feather-icons/feather.min.js"></script>
    <script src="~/assets/js/pages/form-wizard.init.js"></script>
    <script src="~/assets/js/pages/form-advanced.init.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="~/assets/libs/alertifyjs/build/alertify.min.js"></script>
</body>
</html>

<script>
    function addHidden() {
        $('#errorId').css({ 'display': 'none', 'margin-left': '70px', 'width': '300px' });
    }
    function checkButtonLabel() {
        const button = document.getElementById('nextBtn');
        const buttonText = button.innerText || button.textContent;

        if (buttonText.trim().toLowerCase() === 'submit') {
            validateForm();
        } else {
            nextPrev(1);
        }
    }
    function validateForm() {
        debugger;
        const requiredFields = document.querySelectorAll('#companyForm input[required], #companyForm select[required]');

        for (let i = 0; i < requiredFields.length; i++) {
            if (!requiredFields[i].value) {
                $('#errorId').css({ 'display': 'block', 'margin-left': '70px', 'width': '300px' });
                return false;
            }
        }
        SubmitOnboardingRequest();
    }
    function SubmitOnboardingRequest() {
        debugger;
        let company = document.getElementById('CompayId').value;
        let vat = document.getElementById('VatNoId').value;
        let industry = document.getElementById('industryId').value;
        let country = document.getElementById('countryId').value;
        let domain = document.getElementById('domainId').value;
        let firstname = document.getElementById('fistnameId').value;
        let lastname = document.getElementById('lastnameId').value;
        let email = document.getElementById('emailId').value;
        let phone = document.getElementById('phoneId').value;

        $.ajax({
            url: '@Url.Action("SubmitOnboarding", "Onboarding")',
            type: 'POST',
            dataType: 'json',
            data: { company: company, vat: vat, industry: industry, country: country, domain: domain, firstname: firstname, lastname: lastname, email: email, phone: phone },
            success: function (response) {
                debugger;
                if (response.status) {
                    document.getElementById("companyForm").reset();
                    document.getElementById('btnCloseOnboardingId').click();
                    nextPrev(-1);
                    alertify.success("Onboarding Request Submited");
                    setTimeout(function () {
                        alertify.success("An email has been sent to: " + response.email);
                    }, 3000);
                } else
                    alert('faild to submit the request')

            },
            error: function (xhr, status, error) {
                console.log('Request failed: ' + status + ', ' + error);
            }
        });
    }
</script>